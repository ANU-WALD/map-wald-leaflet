{"version":3,"file":"map-wald-leaflet.js","sources":["ng://map-wald-leaflet/leaflet.service.ts","ng://map-wald-leaflet/leaflet-map.component.ts","ng://map-wald-leaflet/draw.component.ts","ng://map-wald-leaflet/geojson-layer.component.ts","ng://map-wald-leaflet/legend.component.ts","ng://map-wald-leaflet/map-control.component.ts","ng://map-wald-leaflet/one-time-splash.component.ts","ng://map-wald-leaflet/vector-tile-layer.component.ts","ng://map-wald-leaflet/wms-layer.component.ts","ng://map-wald-leaflet/date-element.component.ts","ng://map-wald-leaflet/date-selection.component.ts","ng://map-wald-leaflet/data/index.ts","ng://map-wald-leaflet/index.ts","ng://map-wald-leaflet/map-wald-leaflet.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport * as leaflet from 'leaflet';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class LeafletService {\n  map: Promise<leaflet.Map>;\n  private resolve: ((x: leaflet.Map)=>void);\n  private reject: ((x: any)=>void);\n\n  constructor() {\n    this.map = new Promise<leaflet.Map>((res,rej)=>{\n      this.resolve = res;\n      this.reject = rej;\n    });\n  }\n\n  mapCreated(map: leaflet.Map): void {\n    this.resolve(map);\n  }\n\n  withMap(fn:((m:L.Map)=>void)): void {\n    this.map.then(fn);\n  }\n}\n","import { Component, OnInit, OnChanges, SimpleChanges, ElementRef, Input } from '@angular/core';\nimport * as leaflet from 'leaflet';\nimport { LeafletService } from './leaflet.service';\nimport { Bounds } from 'map-wald';\nimport { BasemapDescriptor } from './data';\n\nconst DEFAULT_BASE_MAP='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n@Component({\n  selector: 'leaflet-map',\n  template: `<div class=\"leafletHost\" [style]=\"styles\">\n  <ng-content></ng-content>\n</div>\n`,styles: [\n  `\n  .leafletHost{\n    width:100%;\n    min-height:400px;\n  }`\n]\n})\nexport class LeafletMapComponent implements OnInit, OnChanges {\n  @Input() bounds: Bounds;\n  @Input() baseMap: BasemapDescriptor;\n  @Input() zoomControl = true;\n  @Input() minZoom = 5;\n  @Input() maxZoom = 32;\n\n  map: leaflet.Map;\n  styles: any = {};\n  initialised = false;\n\n  // Leaflet.TileLayer\n  private baseLayer: leaflet.TileLayer;\n\n  constructor(private element: ElementRef, private svc: LeafletService) {\n    console.log('LeafletMapComponent');\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if(!this.initialised){\n      return;\n    }\n\n    const changeCount = Object.keys(changes).length;\n\n    // if(this.creating){\n    //   return;\n    // }\n\n    // if(this.map){\n    //   if(changes.markers){\n    //     this.setupMarkers();\n\n    //     if(changeCount===1){\n    //       return;\n    //     }\n    //   }\n    //   this.map.remove();\n    // }\n\n//    if(!this.creating){\n    this.updateMap(changes);\n//    }\n\n    if(changes.bounds){\n      this.setBounds();\n    }\n  }\n\n  ngOnInit(): void {\n    this.updateMap();\n    this.setBounds();\n  }\n\n  updateMap(changes?: SimpleChanges): void {\n    setTimeout(()=>{\n      if(!this.map){\n        this.createMap();\n        return;\n      }\n\n      if(changes&&changes.baseMap){\n        // this.baseLayer.setUrl(this.baseMap.urlTemplate || DEFAULT_BASE_MAP)\n        if(this.baseLayer){\n          this.baseLayer.setUrl(this.baseMap.urlTemplate || DEFAULT_BASE_MAP);\n          // this.baseLayer.removeFrom(this.map);\n        } else if(this.baseMap) {\n          this.createBaseLayer();\n          this.baseLayer.addTo(this.map).bringToBack();\n        }\n      }\n    });\n\n    // Update parameters\n  }\n\n  createBaseLayer(): void {\n    this.baseLayer = null;\n    if(!this.baseMap){\n      return;\n    }\n\n    const options: leaflet.TileLayerOptions = {};\n    if(this.baseMap.maxNativeZoom){\n      options.maxNativeZoom = this.baseMap.maxNativeZoom;\n    }\n\n    this.baseLayer = leaflet.tileLayer(this.baseMap.urlTemplate || DEFAULT_BASE_MAP,options);\n  }\n\n  createMap(): void {\n    setTimeout(()=>{\n      if(this.map){\n        this.map.remove();\n        this.map = null;\n      }\n\n      const theDiv = this.element.nativeElement as HTMLElement;\n      const theHost = theDiv.querySelector('.leafletHost');\n\n      // let baseLayers = R.mapObjIndexed(v=>{\n      //   return L.tileLayer(v,\n      //     { maxZoom: 18, attribution: '...' });\n      // },this.baseMaps);\n\n      // if(!this.baseMap || !baseLayers[this.baseMap]){\n      //   this.baseMap = Object.keys(this.baseMaps)[0];\n      // }\n\n      // let baseLayerArray = [baseLayers[this.baseMap]];\n      let crs = leaflet.CRS.EPSG3857;//:L.CRS.Simple;\n      // if(this.crs){\n      //   crs = L.CRS[this.crs];\n      // }\n\n      // let panes = 0;\n      // if(this.map){\n      //   panes = getCustomMapPanes(this.map).length;\n      // }\n      this.createBaseLayer();\n      const baseLayerArray = [\n      ];\n      if(this.baseLayer){\n        baseLayerArray.push(this.baseLayer);\n      }\n\n      this.map = leaflet.map(theHost as HTMLElement,{\n        crs,\n        zoom: 5,\n        minZoom: this.minZoom,\n        maxZoom: this.maxZoom,\n        zoomControl: this.zoomControl,\n        center: leaflet.latLng(-20, 135),\n        // zoom: this.zoom,\n        // minZoom: this.minZoom,\n        // maxZoom: this.maxZoom,\n        scrollWheelZoom: true,\n        layers:baseLayerArray,\n        continuousWorld: false,\n        noWrap: true\n            // attributionControl: this.attribution\n      } as leaflet.MapOptions);\n      this.svc.mapCreated(this.map);\n      // if(!this.pannable){\n      //   this.map.dragging.disable();\n      // }\n\n      // if(!this.zoomable){\n      //   this.map.touchZoom.disable();\n      //   this.map.doubleClickZoom.disable();\n      //   this.map.scrollWheelZoom.disable();\n      // }\n\n      // configureVectorPanes(panes,this.map);\n\n      // this._helper.register(this.map);\n      this.map.on('click',(evt: leaflet.LeafletMouseEvent)=>{\n        if(evt.originalEvent.defaultPrevented){\n          return;\n        }\n        // this.pointClick.emit(evt.latlng);\n      });\n      // this.creating=false;\n\n      // this.map.on('zoomend',()=>this.coordinatesChanged());\n      // this.map.on('moveend',()=>this.coordinatesChanged());\n\n      // if(this.showLayerControl){\n      //   this.layerControl = L.control.layers(baseLayers, [],{\n      //     hideSingleBase:true\n      //   }).addTo(this.map);\n      // }\n\n      // this.mapCreated.emit(this.map);\n\n\n\n      // this.markerLayers = [];\n      // this.setupMarkers();\n\n      this.setBounds();\n      this.initialised = true;\n    });\n\n  }\n\n  setBounds(): void {\n    if(!this.map||!this.bounds){\n      return;\n    }\n\n    this.map.fitBounds([\n      [this.bounds.south,this.bounds.west],\n      [this.bounds.north,this.bounds.east]\n    ]);\n  }\n\n}\n/*\nhttp://35.244.111.168:8080/wms\n?service=WMS\n&request=GetMap\n&layers=wcf\n&styles=\n&format=image%2Fpng\n&transparent=true\n&version=1.1.1\n&time=2019-01-01T00%3A00%3A00.000Z\n&width=256\n&height=256\n&srs=EPSG%3A3857\n&bbox=-17532819.79994059,-5009377.085697311,-15028131.257091936,-2504688.542848655\n\n*/\n","import { Component, OnInit, Output, EventEmitter, OnDestroy } from '@angular/core';\nimport * as L from 'leaflet';\nimport 'leaflet-draw';\nimport { LeafletService } from './leaflet.service';\n\n@Component({\n  selector: 'draw',\n  template: '',\n  styles: []\n})\nexport class DrawComponent implements OnInit, OnDestroy {\n  @Output() featureClosed = new EventEmitter<any>();\n\n  private drawnItems: L.FeatureGroup;\n  private drawControl: L.Control.Draw;\n  private polygon: L.Draw.Polygon;\n\n  constructor(private map: LeafletService) { }\n\n  ngOnDestroy(): void {\n    this.map.withMap(m=>this.removeControl(m))\n  }\n\n  ngOnInit(): void {\n    this.map.withMap(m=>this.addControl(m))\n  }\n\n  removeControl(m: L.Map): void {\n    m.removeLayer(this.drawnItems);\n    this.polygon.removeHooks();\n    // m.removeControl(this.drawControl);\n    m.off(L.Draw.Event.DRAWSTART);\n    m.off(L.Draw.Event.CREATED);\n  }\n\n  addControl(m: L.Map): void {\n    this.drawnItems = new L.FeatureGroup();\n    m.addLayer(this.drawnItems);\n\n    // this.drawControl = new L.Control.Draw({\n    //   draw: {\n    //     polyline: false,\n    //     circle: false,\n    //     marker: false,\n    //     rectangle: false,\n    //     circlemarker: false\n    //   },\n    //   edit: null\n    // });\n    // m.addControl(this.drawControl);\n    this.initiateDrawing(m);\n\n    m.on(L.Draw.Event.DRAWSTART, (event) => {\n      this.drawnItems.clearLayers();\n    });\n\n    m.on(L.Draw.Event.DRAWVERTEX, (event) => {\n      this.drawnItems.clearLayers();\n    });\n\n    m.on(L.Draw.Event.CREATED, (event) => {\n      console.log(event);\n\n      const layer = event.layer;\n      this.drawnItems.clearLayers();\n      this.drawnItems.addLayer(layer);\n      this.featureClosed.emit(layer.toGeoJSON());\n      this.polygon.removeHooks();\n      this.initiateDrawing(m);\n    });\n  }\n\n  initiateDrawing(m: L.Map): void {\n    this.polygon = new L.Draw.Polygon(m as L.DrawMap, {repeatMode: false});\n    this.polygon.addHooks();\n  }\n}\n\n\n","import { Component, OnInit, Input, OnChanges, SimpleChanges, Output, EventEmitter, OnDestroy } from '@angular/core';\nimport * as L from 'leaflet';\nimport 'leaflet.vectorgrid';\nimport { LeafletService } from './leaflet.service';\nimport { TiledSublayerDescriptor } from './data';\nimport { HttpClient } from '@angular/common/http';\n\nconst STYLES = {\n  fillOpacity: 0.0,\n  weight: 1.0\n};\n\n@Component({\n  selector: 'geojson-layer',\n  template: '',\n  styles: ['']\n})\nexport class GeojsonLayerComponent implements OnInit, OnChanges, OnDestroy {\n  @Input() url: string;\n  @Input() styles: any;\n  @Input() sublayers: TiledSublayerDescriptor[] = [];\n  // @Input() idColumn = 'id';\n  @Output() featureSelected = new EventEmitter<any>();\n\n  private destroyed = false;\n  private selectedFeature: any;\n  private vectorLayer: L.GeoJSON;\n  // private data: any;\n\n  constructor(private http: HttpClient, private map: LeafletService) {\n  }\n\n  ngOnInit(): void {\n  }\n\n  ngOnDestroy(): void {\n    this.destroyed = true;\n    this.map.map.then(m => {\n      this.remove(m);\n    });\n  }\n\n  private remove(m: L.Map): void {\n    if (this.vectorLayer) {\n      this.vectorLayer.removeFrom(m);\n      this.vectorLayer = null;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.url) {\n      this.http.get(this.url).subscribe((data: any) => {\n        if (changes.url.currentValue !== this.url) {\n          // out of date!\n          return;\n        }\n\n        this.map.map.then(m => {\n          this.remove(m);\n          if (this.destroyed) {\n            return;\n          }\n\n          this.vectorLayer = L.geoJSON(data, {\n            // interactive: true\n            style: STYLES\n          });\n\n          this.vectorLayer.on('click' as any, (event) => {\n            if (this.selectedFeature) {\n              this.vectorLayer.resetStyle(this.selectedFeature);\n              // resetFeatureStyle(this.selectedFeature);\n            }\n            this.selectedFeature = event.layer;\n            this.selectedFeature.setStyle({\n              weight:5\n            });\n\n            this.featureSelected.emit(this.selectedFeature.feature);\n          });\n          this.vectorLayer.addTo(m);\n        });\n      });\n    }\n  }\n}\n","import { Component, OnInit, Input } from '@angular/core';\n\n@Component({\n  selector: 'legend',\n  template: `<div class=\"map-legend panel panel-group\">\n<ng-template #tooltipContent>\n  <span [innerHtml]=helpText></span>\n</ng-template>\n  <strong>{{title}} <span *ngIf=\"mapUnits\" [innerHTML]=\"'('+mapUnits+')'\"></span>\n        <span *ngIf=\"helpText\"\n              [ngbTooltip]=\"tooltipContent\"\n              [placement]=\"tooltipPlacement\"\n              container=\"body\">\n          <i class=\"fa fa-info-circle\"></i>\n        </span>\n  </strong>\n\n  <div *ngIf=\"!imageURL\">\n    <div style=\"display:table;line-height:15px\">\n      <div style=\"display:table-row;padding:0;\"\n          *ngFor=\"let colour of colours; let i=index\">\n        <div class=\"legend-colour\">\n          <i class=\"legend-entry\" [ngStyle]=\"{background:colour}\"></i>\n        </div>\n        <div class=\"legend-label\">\n          <span [innerHTML]=\"labels[i]\"></span>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div *ngIf=\"imageURL\">\n    <img [src]=\"imageURL\">\n  </div>\n  <p *ngIf=\"attributionLink\">Source: <a [href]=\"attributionLink\">{{attribution || 'details'}}</a></p>\n  <p *ngIf=\"attribution&&!attributionLink\">Source: {{attribution}}</p>\n</div>\n`, styles: [`\n.map-legend{\n  display:block;\n  background: white;\n}\n\n.legend-colour{\n  display:table-cell;\n  padding:0px;\n}\n\n.legend-label{\n  display:table-cell;\n  padding:0px 4px 2px 2px;\n  font-size:10px;\n  vertical-align:middle;\n}\n\n.legend-entry {\n  float: left;\n  width: 15px !important;\n  height: 15px !important;\n}\n`]\n})\nexport class LegendComponent implements OnInit {\n  @Input() colours: Array<string> = ['red', 'white', 'blue'];\n  @Input() labels: Array<string> = [];\n\n  @Input() imageURL: string\n  @Input() title = 'the title';\n  @Input() mapUnits = '';\n  @Input() helpText: string;\n  @Input() tooltipPlacement = 'right';\n  @Input() attribution: string;\n  @Input() attributionLink: string;\n\n  generatedLabels: string[] = [];\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n\nexport function makeColour(r: number, g: number, b: number, a?: number): string {\n  a = (a === undefined) ? 1 : a;\n  return `rgb(${r},${g},${b},${a})`;\n}\n\n","/// <reference types=\"./leaflet.customcontrols\" />\n\nimport { Component, OnInit, ViewChild, Input, AfterViewInit, ElementRef } from '@angular/core';\nimport { LeafletService } from './leaflet.service';\nimport * as leaflet from 'leaflet';\n\ninterface SavedMapSettings {\n  pan: boolean;\n  zoom: boolean;\n}\n\nconst TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'];\n\n@Component({\n  selector: 'map-control',\n  template: `<div #mapControl class=\"map-control-content\"\n                  (touchstart)=\"ontouchstart($event)\"\n                  (mouseenter)=\"disableMapEvents()\"\n                  (mouseleave)=\"enableMapEvents()\">\n  <ng-content></ng-content>\n</div>\n`, styles: [`.map-control-content{\n  background: transparent;\n}\n`],\n})\nexport class MapControlComponent implements OnInit, AfterViewInit {\n  @ViewChild('mapControl', { static: false }) mapControl: Component;\n  @Input() position = 'TOP_RIGHT';\n  touchDevice = false;\n\n  constructor(private _el: ElementRef, private _map: LeafletService) { }\n\n  ngOnInit(): void {\n  }\n\n  ngAfterViewInit(): void {\n    // this._wrapper.getNativeMap().then((m)=>{\n    let content: HTMLElement = this._el.nativeElement.querySelector('.map-control-content');\n\n    //   // If content of the map control is not already wrapped in a div, do it\n    //   // now.\n    if (content.nodeName !== \"DIV\") {\n      const controlDiv: HTMLElement = document.createElement('div');\n      controlDiv.appendChild(content);\n      content = controlDiv;\n    }\n\n    const CustomControl = leaflet.Control.extend({\n      onAdd: (map:leaflet.Map) => {\n        return content;\n      },\n\n      onRemove: (map:leaflet.Map) => {\n        // Nothing to do here\n      }\n    });\n\n    const makeCustomControl = (opts:any) => {\n      return new CustomControl(opts);\n    };\n\n    this._map.map.then(map => {\n      const c = makeCustomControl({\n        position: this.position.replace(/_/g,'').toLowerCase()\n      });\n      c.addTo(map);\n    });\n    //   (<any>m).controls[(<any>window).google.maps.ControlPosition[this.position]].push(content);\n    // });\n  }\n\n  ontouchstart(ev: TouchEvent): void {\n    this.touchDevice = true;\n    if(TAG_WHITE_LIST.indexOf((ev.target as any).tagName)>=0){\n      ev.stopPropagation();\n    }\n    this.enableMapEvents();\n  }\n\n  disableMapEvents(): void {\n    if(this.touchDevice){\n      return;\n    }\n\n    this._map.map.then(m=>{\n      m.dragging.disable();\n      m.scrollWheelZoom.disable();\n    });\n  }\n\n  enableMapEvents(): void {\n    this._map.map.then(m=>{\n      const options = {\n        pan:true,\n        zoom:true\n      };\n\n      if(options.pan){\n        m.dragging.enable();\n      }\n\n      if(options.zoom){\n        m.scrollWheelZoom.enable();\n      }\n    });\n  }\n\n}\n","import { Component, Input, ViewChild, AfterViewInit, ElementRef, EventEmitter, Output } from '@angular/core';\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\nimport * as store from 'store';\n\nexport enum SplashCloseMode {\n  NotOpened,\n  Accepted,\n  Cancelled\n}\n\n@Component({\n  selector: 'one-time-splash',\n  template: `<ng-template #splashTemplate let-c=\"close\" let-d=\"dismiss\">\n  <div *ngIf=\"label\" class=\"modal-header\">\n    <h4 class=\"modal-title\">\n      {{label}}</h4>\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d('Cross click')\">\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n    <ng-content></ng-content>\n  </div>\n  <div class=\"modal-footer\">\n    <label *ngIf=\"application\">\n      <input type=\"checkbox\" [(ngModel)]=\"doNotShow\" (ngModelChange)=\"doNotShowClicked()\">\n      &nbsp; {{hideMessage}}\n    </label>\n    <button autofocus type=\"button\" class=\"btn btn-secondary\" (click)=\"c('Close click')\">Close</button>\n  </div>\n  </ng-template>\n`,\n  styles: [``]\n})\nexport class OneTimeSplashComponent implements AfterViewInit  {\n  @ViewChild('splashTemplate',{static:false}) splashTemplate:any;\n  @Input() application:string;\n  @Input() label = 'About';\n  @Input() hideMessage = 'Understood, I donât need to see this again';\n  @Input() klass: string;\n  @Input() showOnLaunch = true;\n  @Output() closed = new EventEmitter<SplashCloseMode>();\n  doNotShow: boolean;\n  current:NgbModalRef;\n\n  constructor(private modalService: NgbModal){\n\n  }\n\n  storageKey(): string {\n    if(!this.application){\n      return null;\n    }\n\n    return this.application  + '-splash-skip';\n  }\n\n  ngAfterViewInit(): void {\n    setTimeout(()=>{\n      const key = this.storageKey();\n      if(key){\n        this.doNotShow = store.get(key,false);\n      }\n\n      if(this.showOnLaunch){\n        this.defaultShow();\n      }\n    });\n  }\n\n  defaultShow(): void {\n    if(!this.doNotShow){\n      this.show();\n    } else {\n      this.closed.emit(SplashCloseMode.NotOpened);\n    }\n  }\n\n  show(): void {\n    this.current = this.modalService.open(this.splashTemplate,{\n      size:'lg',\n      windowClass:this.klass\n    });\n  }\n\n  close(): void {\n    if(!this.current){\n      this.closed.emit(SplashCloseMode.NotOpened);\n      return;\n    }\n\n    this.current.close();\n    this.current=null;\n    this.closed.emit(SplashCloseMode.Accepted);\n  }\n\n  doNotShowClicked(): void {\n    const key = this.storageKey();\n    if(!key){\n      return;\n    }\n\n    store.set(key,this.doNotShow);\n  }\n}\n","/// <reference types=\"./leaflet.vectorgrid\" />\n\nimport { Component, OnInit, Input, OnChanges, SimpleChanges, Output, EventEmitter, OnDestroy } from '@angular/core';\nimport * as leaflet from 'leaflet';\n// import 'leaflet.vectorgrid';\nimport { LeafletService } from './leaflet.service';\nimport { TiledSublayerDescriptor } from './data';\n\n@Component({\n  selector: 'vector-tile-layer',\n  template: '',\n  styles: []\n})\nexport class VectorTileLayerComponent implements OnInit, OnChanges, OnDestroy {\n  @Input() url: string;\n  @Input() styles: any;\n  @Input() sublayers: TiledSublayerDescriptor[] = [];\n  @Output() featureSelected = new EventEmitter<any>();\n\n  private destroyed = false;\n  private selectedFeature: any;\n  private vectorLayer: L.VectorGridLayer;\n\n  constructor(private map: LeafletService) { }\n\n  ngOnInit(): void {\n  }\n\n  ngOnDestroy(): void {\n    this.destroyed = true;\n    this.map.map.then(m=>{\n      this.remove(m);\n    });\n  }\n\n  private getFeatureId(f:any): string {\n    const match = this.sublayers.find(v=>f.properties[v.keyField]);\n    return f.properties[match.keyField];\n  }\n\n  private remove(m: L.Map): void {\n    if(this.vectorLayer){\n      this.vectorLayer.removeFrom(m);\n      this.vectorLayer = null;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.map.map.then(m=>{\n      this.remove(m);\n      if(this.destroyed){\n        return;\n      }\n\n      this.vectorLayer = L.vectorGrid.protobuf(this.url,{\n        minZoom:11,\n        interactive: true,\n        vectorTileLayerStyles: this.styles,\n        maxNativeZoom:13,\n        getFeatureId: (f:any) => this.getFeatureId(f)\n      });\n\n      this.vectorLayer.on('click' as any,(event)=>{\n        if(this.selectedFeature){\n          this.vectorLayer.resetFeatureStyle(this.selectedFeature);\n        }\n        this.selectedFeature = this.getFeatureId(event.layer);\n        this.vectorLayer.setFeatureStyle(this.selectedFeature, {\n          weight:5\n        });\n\n        const geoJSON = this.vectorGridFeatureToGeoJSON(event.layer);\n        this.featureSelected.emit(geoJSON);\n      });\n      this.vectorLayer.addTo(m);\n    });\n  }\n\n  vectorGridFeatureToGeoJSON(lyr:any):any{\n    const parts:any[][] = (lyr._parts[0]&&lyr._parts[0][0])?lyr._parts:[lyr._parts];\n    const points = (parts as any[]).map((part:any[])=>{\n      return part.map(pt=>([pt.x,pt.y] as number[]));\n    });\n    const minx = Math.min(...points[0].map(pt=>pt[0]));\n    const maxx = Math.max(...points[0].map(pt=>pt[0]));\n\n    const miny = Math.min(...points[0].map(pt=>pt[1]));\n    const maxy = Math.max(...points[0].map(pt=>pt[1]));\n\n    function converter(from:number[],to:number[]): ((c:number)=>number) {\n      const fromDelta = from[1]-from[0];\n      const toDelta = to[1] - to[0];\n      return (c)=>to[0] + ((c-from[0])/fromDelta) * toDelta;\n    }\n\n    const xConverter = converter([minx,maxx],[lyr.properties.minx,lyr.properties.maxx]);\n    const yConverter = converter([miny,maxy],[lyr.properties.maxy,lyr.properties.miny]);\n\n    return {\n      type:'Feature',\n      geometry:{\n        type:'Polygon',\n        coordinates:points.map(part=>part.map(pt=>[xConverter(pt[0]),yConverter(pt[1])]))\n      },\n      properties:lyr.properties\n    };\n  }\n\n}\n","import { Component, OnInit, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { LeafletService } from './leaflet.service';\nimport * as L from 'leaflet';\n\nconst DEFAULT_WMS_PARAMS = {\n  format: 'image/png',\n  transparent: true\n};\n\n@Component({\n  selector: 'wms-layer',\n  template: '',\n  styles: []\n})\nexport class WmsLayerComponent implements OnInit, OnChanges {\n  @Input() url: string;\n  @Input() params: any = {};\n  private layer: L.TileLayer;\n\n  constructor(private map: LeafletService) { }\n\n  ngOnInit(): void {\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.map.map.then(m=>{\n      if(this.layer){\n        this.layer.removeFrom(m);\n        this.layer = null;\n      }\n      if(!this.url||!this.params){\n        return;\n      }\n\n      const params = Object.assign({},DEFAULT_WMS_PARAMS,this.params);\n      this.layer = L.tileLayer.wms(this.url,params as L.WMSOptions);\n\n      this.layer.addTo(m);\n    });\n  }\n\n}\n","import { Component, Input, ViewChild, AfterViewInit, ElementRef, Output, EventEmitter } from '@angular/core';\n\n\ndeclare var Plotly: any;\n\n@Component({\n  selector: 'date-element',\n  template: `<div class=\"row no-gutters\">\n  <div class=\"col-4\">{{label}}</div>\n  <div class=\"col-2\">\n    <button class=\"btn btn-secondary btn-sm\"\n            (click)=\"move(-step)\"\n            [disabled]=\"disabled\">\n      <i class=\"fa fa-angle-left\"></i>\n    </button>\n  </div>\n  <div class=\"col-4\"><button class=\"btn btn-link btn-sm\">{{src[property]}}</button></div>\n  <div class=\"col-2\">\n    <button class=\"btn btn-secondary btn-sm\"\n            (click)=\"move(step)\"\n            [disabled]=\"disabled\">\n      <i class=\"fa fa-angle-right\"></i>\n    </button>\n  </div>\n</div>\n`,styles: []})\nexport class DateElementComponent implements AfterViewInit  {\n  @Input() label:string;\n  @Input() property:string;\n  @Input() src:any;\n  @Input() step = 1;\n  @Output() changed = new EventEmitter<any>();\n  @Input() disabled = false;\n\n  constructor(){\n\n  }\n\n  ngAfterViewInit(){\n\n  }\n\n  move(n:number){\n    this.src[this.property] += n;\n    this.changed.emit(this.src);\n  }\n}\n","import { Component, Input, ViewChild, AfterViewInit, ElementRef, Output, EventEmitter } from '@angular/core';\nimport { NgbDateStruct } from '@ng-bootstrap/ng-bootstrap';\nimport { TimeUtilsService, InterpolationService } from 'map-wald';\n\nconst MILLISECONDS_PER_DAY=24*60*60*1000;\n\ndeclare var Plotly: any;\n\n@Component({\n  selector: 'date-selection',\n  template: `<div class=\"date-control container-fluid\">\n  <div *ngIf=\"style!=='arrows'\" class=\"row no-gutters\">\n    <div class=\"col-12 form-group-inline\">\n        <div class=\"input-group input-group-sm\">\n          <div *ngIf=\"step\" class=\"ds-btn input-group-addon\" (click)=\"move(-stepDays)\">\n            <i class=\"fa fa-angle-left\"></i>\n          </div>\n          <input class=\"form-control form-control-sm\"\n                 placeholder=\"yyyy-mm-dd\"\n                 name=\"dp\"\n                 [(ngModel)]=\"dateStruct\"\n                 (ngModelChange)=\"dateStructChanged()\"\n                 ngbDatepicker\n                 #d=\"ngbDatepicker\"\n                 [maxDate]=\"maxDateStruct\"\n                 [minDate]=\"minDateStruct\"\n                 [disabled]=\"disabled\">\n          <div class=\"ds-btn input-group-addon\" (click)=\"disabled||d.toggle()\" >\n            <i class=\"fa fa-calendar\"></i>\n          </div>\n          <div *ngIf=\"step\" class=\"ds-btn input-group-addon\" (click)=\"move(stepDays)\">\n            <i class=\"fa fa-angle-right\"></i>\n          </div>\n        </div>\n      </div>\n\n    <!--\n      <div class=\"col-2\" >\n        <button class=\"btn btn-secondary btn-sm\" [disabled]=\"atMax\"\n                (click)=\"move(1)\"><i class=\"fa fa-chevron-right\"></i></button>\n      </div>\n    -->\n  </div>\n\n  <div *ngIf=\"style==='arrows'\">\n    <date-element *ngIf=\"need.day\"   [src]=\"dateStruct\" [property]=\"'day'\" [label]=\"'Day'\"\n                  [step]=\"stepDays\"\n                  (changed)=\"dateStructChanged()\"\n                  [disabled]=\"disabled\"></date-element>\n    <date-element *ngIf=\"need.month\" [src]=\"dateStruct\" [property]=\"'month'\" [label]=\"'Month'\"\n                  (changed)=\"dateStructChanged()\"\n                  [disabled]=\"disabled\"></date-element>\n    <date-element *ngIf=\"need.year\"  [src]=\"dateStruct\" [property]=\"'year'\" [label]=\"'Year'\"\n                  (changed)=\"dateStructChanged()\"\n                  [disabled]=\"disabled\"></date-element>\n  </div>\n</div>\n`,styles: [\n  `\n  .dc-btn {\n    min-width:10px;\n  }\n  `\n]})\nexport class DateSelectionComponent implements AfterViewInit  {\n  @Input() date: Date;\n  @Output() dateChange = new EventEmitter();\n  @Input() timestep: string;\n  @Input() minDate: Date|string;\n  @Input() maxDate: Date|string;\n  @Input() style: ('popup'|'arrows') = 'arrows';\n  @Input() stepDays = 1;\n  @Input() referenceDate:string = null;\n  @Input() disabled = false;\n  @Input() step = false;\n\n  need = {\n    day:true,\n    month:true,\n    year:true\n  };\n\n  minDateStruct:NgbDateStruct;\n  maxDateStruct:NgbDateStruct;\n  dateStruct:NgbDateStruct;\n\n  atMax:boolean=false;\n  atMin:boolean=false;\n\n  constructor(private timeUtils: TimeUtilsService){\n\n  }\n\n  ngAfterViewInit(){\n\n  }\n\n  ngOnChanges(changes:any){\n    if(changes.minDate){\n      this.minDateStruct = this.timeUtils.convertDate(this.minDate);\n    }\n\n    if(changes.maxDate){\n      this.maxDateStruct = this.timeUtils.convertDate(this.maxDate);\n    }\n\n    if(changes.date){\n      this.dateStruct = this.timeUtils.convertDate(this.date);\n    }\n\n    if(changes.timestep){\n      this.assessDateComponents();\n    }\n    this.checkLimits();\n  }\n\n  dateStructChanged(){\n    this.date = new Date(Date.UTC(this.dateStruct.year,this.dateStruct.month-1,this.dateStruct.day));\n    // this.date.setUTCFullYear(this.dateStruct.year)\n    // this.date.setUTCMonth(this.dateStruct.month-1)\n    // this.date.setUTCDate(this.dateStruct.day);\n    this.checkReference();\n    this.dateChange.emit(this.date);\n  }\n\n  assessDateComponents(){\n    this.need.day = this.need.month = this.need.year = true;\n    if(this.timestep==='daily'){\n      return;\n    }\n    this.need.day = false;\n\n    if(this.timestep==='annual') {\n      this.need.month = false;\n    }\n  }\n\n  move(n:number){\n    this.date = new Date(this.date&&this.date.getTime());\n    this.date.setDate(this.date.getDate()+n);\n    this.onDateChanged();\n    this.dateChange.emit(this.date);\n  }\n\n  onDateChanged(){\n    this.checkLimits();\n  }\n\n  checkLimits(){\n    this.atMax = this.timeUtils.datesEqual(this.dateStruct,this.maxDateStruct);\n    this.atMin = this.timeUtils.datesEqual(this.dateStruct,this.minDateStruct);\n  }\n  // TODO not enforcing limits etc...\n\n  checkReference(): any {\n    if(!this.referenceDate){\n      return;\n    }\n\n    let refComponents = InterpolationService.interpolate(this.referenceDate,{\n      year:this.date.getFullYear(),\n      month:this.date.getMonth()+1,\n      date:this.date.getDate()\n    }).split('-').map(s=>+s);\n\n    let currentRef = new Date(Date.UTC(refComponents[0],refComponents[1]-1,refComponents[2]));\n\n    console.log('currentRef',currentRef);\n    console.log('currentDate',this.date);\n    let timeSpan = MILLISECONDS_PER_DAY * this.stepDays;\n\n    let days = (this.date.getTime() - currentRef.getTime())/timeSpan;\n    this.date = new Date(currentRef.getTime() + Math.round(days)*timeSpan);\n    this.dateStruct = this.timeUtils.convertDate(this.date);\n  }\n\n}\n","\n\nexport * from './basemap-descriptor';\nexport * from './vector-layer-descriptor';\n\n\n// export * from './display-settings';\n// export * from './layer-descriptor';\n// export * from './legend-response';\n// export * from './map-settings';\n\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\nimport { HttpClientModule } from '@angular/common/http';\nimport { CommonModule } from '@angular/common';\nimport { MapWaldCoreModule } from 'map-wald';\n\nimport { LeafletService } from './leaflet.service';\nimport { LeafletMapComponent } from './leaflet-map.component';\nimport { DrawComponent } from './draw.component';\nimport { GeojsonLayerComponent } from './geojson-layer.component';\nimport { LegendComponent } from './legend.component';\nimport { MapControlComponent } from './map-control.component';\nimport { OneTimeSplashComponent } from './one-time-splash.component';\nimport { VectorTileLayerComponent } from './vector-tile-layer.component';\nimport { WmsLayerComponent } from './wms-layer.component';\nimport { DateElementComponent } from './date-element.component';\nimport { DateSelectionComponent } from './date-selection.component';\n\nexport * from './data';\nexport * from './leaflet.service';\nexport * from './leaflet-map.component';\nexport * from './draw.component';\nexport * from './geojson-layer.component';\nexport * from './legend.component';\nexport * from './map-control.component';\nexport * from './one-time-splash.component';\nexport * from './vector-tile-layer.component';\nexport * from './wms-layer.component';\nexport * from './date-element.component';\nexport * from './date-selection.component';\n\nconst components: any[] = [\n  //$componentList\n  DrawComponent,\n  GeojsonLayerComponent,\n  LeafletMapComponent,\n  LegendComponent,\n  MapControlComponent,\n  OneTimeSplashComponent,\n  VectorTileLayerComponent,\n  WmsLayerComponent,\n  DateElementComponent,\n  DateSelectionComponent\n];\n\nconst services: any[] = [\n  //$serviceList\n  LeafletService  \n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    HttpClientModule,\n    NgbModule,\n    MapWaldCoreModule\n  ],\n  declarations: components,\n  exports: components,\n  providers: services\n})\nexport class MapWaldLeafletModule {\n  static forRoot(moduleInitialisation:any): ModuleWithProviders<MapWaldLeafletModule> {\n    return {\n      ngModule: MapWaldLeafletModule,\n      providers: services\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["core_1","L","map_wald_1","draw_component_1","geojson_layer_component_1","leaflet_map_component_1","legend_component_1","map_control_component_1","one_time_splash_component_1","vector_tile_layer_component_1","wms_layer_component_1","date_element_component_1","date_selection_component_1","leaflet_service_1","common_1","forms_1","http_1","ng_bootstrap_1"],"mappings":"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"}